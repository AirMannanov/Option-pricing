# Option Pricing Project

Небольшой инструмент для прайсинга опционов на C++ с использованием модели Блэка-Шоулза.

## Описание

Проект предназначен для расчёта справедливой стоимости и греков ванильных опционов на акции. Реализована модель Блэка-Шоулза для расчёта цен европейских Call и Put опционов, а также всех основных греков (Delta, Gamma, Vega, Theta, Rho).

## Возможности

- Расчёт цены опциона по модели Блэка-Шоулза
- Расчёт всех греков (Delta, Gamma, Vega, Theta, Rho)
- Одиночный расчёт через CLI
- Пакетная обработка CSV файлов
- Модульные тесты
- CI/CD через GitHub Actions

## Требования

- C++17 или выше
- CMake 3.15 или выше
- Компилятор с поддержкой C++17 (GCC, Clang, MSVC)

## Сборка

```bash
mkdir build && cd build
cmake ..
cmake --build .
```

Для сборки в режиме Debug:
```bash
cmake -DCMAKE_BUILD_TYPE=Debug ..
cmake --build .
```

## Использование

### Одиночный расчёт

Расчёт цены одного опциона:

```bash
./bin/option_pricer_cli --model black_scholes --type call \
  --spot 100 --strike 105 --rate 0.05 --vol 0.2 --maturity 0.5
```

Расчёт с греками:

```bash
./bin/option_pricer_cli --model black_scholes --type call \
  --spot 100 --strike 105 --rate 0.05 --vol 0.2 --maturity 0.5 \
  --with-greeks
```

### Пакетная обработка

Обработка CSV файла с опционами:

```bash
./bin/option_pricer_cli --batch-input examples/sample_options.csv \
  --batch-output results.csv --with-greeks
```

**Формат входного CSV:**
```csv
type,spot,strike,rate,vol,maturity
call,100.0,105.0,0.05,0.2,0.5
put,100.0,95.0,0.05,0.2,0.25
```

**Формат выходного CSV (с греками):**
```csv
type,spot,strike,rate,vol,maturity,price,delta,gamma,vega,theta,rho
call,100.0,105.0,0.05,0.2,0.5,6.858735,0.445159,0.028076,28.075684,-7.497995,18.828585
```

## Параметры командной строки

### Одиночный режим

- `--model MODEL` - Модель прайсинга (black_scholes)
- `--type TYPE` - Тип опциона (call|put)
- `--spot S` - Цена базового актива
- `--strike K` - Страйк
- `--rate r` - Безрисковая ставка (годовая)
- `--vol σ` - Волатильность (годовая)
- `--maturity T` - Время до экспирации (в годах)
- `--with-greeks` - Рассчитать и вывести греки

### Пакетный режим

- `--batch-input FILE` - Входной CSV файл
- `--batch-output FILE` - Выходной CSV файл
- `--with-greeks` - Включить греки в выходной файл

## Архитектура

Проект организован следующим образом:

```
option-pricing/
├── include/pricing/               # Публичные заголовки
│   ├── core/                      # Доменные сущности
│   │   ├── Option.hpp             # Класс опциона
│   │   ├── MarketData.hpp         # Рыночные данные
│   │   └── PricingResult.hpp      # Результат расчёта
│   └── models/                    # Модели прайсинга
│       ├── PricingModel.hpp       # Интерфейс модели
│       └── BlackScholesModel.hpp  # Интерфейс модели Блэка-Шоулза
├── src/                           # Реализация
│   ├── models/                    # Реализация моделей
│   └── cli/                       # CLI приложение
├── tests/                         # Модульные тесты
├── examples/                      # Примеры использования
└── docs/                          # Документация
```

### Основные компоненты

- **Option** - Описывает опцион (тип, страйк, срок до экспирации)
- **MarketData** - Содержит рыночные данные (цена актива, ставка, волатильность)
- **BlackScholesModel** - Реализация модели Блэка-Шоулза
- **PricingResult** - Результат расчёта (цена и греки)

## Тестирование

Запуск всех тестов:

```bash
cd build
ctest --output-on-failure
```

Или напрямую:

```bash
./bin/test_pricing
```

Запуск конкретных тестов:

```bash
./bin/test_pricing "[black_scholes]"
./bin/test_pricing "[greeks]"
./bin/test_pricing "[batch]"
```

## Производительность

Система способна обрабатывать большие объёмы опционов. Для проверки производительности можно использовать встроенный бенчмарк:

```bash
cd build
./bin/benchmark_pricing
```

Бенчмарк тестирует производительность расчёта цен и греков для различных объёмов данных (100, 1000, 10000 опционов).

Также можно использовать пакетный режим с большим CSV файлом для практической проверки производительности.

## Разработка

### Добавление новой модели прайсинга

1. Создать класс, наследующий `PricingModel`
2. Реализовать метод `price()` и при необходимости `priceWithGreeks()`
3. Добавить тесты для новой модели

### Структура тестов

- `test_black_scholes.cpp` - Тесты модели Блэка-Шоулза и греков
- `test_batch.cpp` - Тесты пакетной обработки

## Документация

- [API Documentation](docs/API.md) - Документация по API

Проект создан в учебных целях.
